{"timestamp":"2025-12-01T05:58:57.005573Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-12-01T05:58:57.006019Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/stock_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-12-01T05:58:57.552655Z","level":"info","event":"[QueryLoader] Loading JSON from: /opt/airflow/query/ticker_info.json","logger":"task.stdout"}
{"timestamp":"2025-12-01T05:58:57.557690Z","level":"error","event":"Exception rendering Jinja template for task 'stock_fetch_task', field 'op_kwargs'. Template: {'start_date': '{{ds - macros.timedelta(hours = 9,days=7).strftime(\"%Y-%m-%d\")}}', 'end_date': '{{ds - macros.timedelta(hours = 9,days=1).strftime(\"%Y-%m-%d\")}}'}","logger":"airflow.sdk.definitions._internal.abstractoperator","filename":"abstractoperator.py","lineno":311,"error_detail":[{"exc_type":"UndefinedError","exc_value":"'datetime.timedelta object' has no attribute 'strftime'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/abstractoperator.py","lineno":305,"name":"_do_render_template_fields"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/templater.py","lineno":192,"name":"render_template"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/templater.py","lineno":177,"name":"render_template"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/abstractoperator.py","lineno":266,"name":"_render"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/templater.py","lineno":133,"name":"_render"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/context.py","lineno":205,"name":"render_template_to_string"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/context.py","lineno":195,"name":"render_template"},{"filename":"<template>","lineno":13,"name":"root"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py","lineno":399,"name":"call"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py","lineno":265,"name":"is_safe_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py","lineno":870,"name":"__getattr__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py","lineno":859,"name":"_fail_with_undefined_error"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-12-01T05:58:57.557846Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"UndefinedError","exc_value":"'datetime.timedelta object' has no attribute 'strftime'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":922,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":812,"name":"_prepare"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":289,"name":"render_templates"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":1569,"name":"render_template_fields"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/abstractoperator.py","lineno":305,"name":"_do_render_template_fields"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/templater.py","lineno":192,"name":"render_template"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/templater.py","lineno":177,"name":"render_template"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/abstractoperator.py","lineno":266,"name":"_render"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/_internal/templater.py","lineno":133,"name":"_render"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/context.py","lineno":205,"name":"render_template_to_string"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/definitions/context.py","lineno":195,"name":"render_template"},{"filename":"<template>","lineno":13,"name":"root"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py","lineno":399,"name":"call"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py","lineno":265,"name":"is_safe_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py","lineno":870,"name":"__getattr__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py","lineno":859,"name":"_fail_with_undefined_error"}],"is_group":false,"exceptions":[]}]}
